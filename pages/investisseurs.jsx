import { useState, useEffect } from 'react'
import Head from 'next/head'
import Link from 'next/link'
import Markdown from 'markdown-to-jsx'
import RegistrationForm from '../sections/components/registration-form'

export default function Investisseurs(props) {

  const [data, setData] = useState(props.data)

  return (
    <div className="investisseurs">
      <Head>
        <title>Koleeum.immo</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <div className="proprietaires fadeIn">
        <div className="container">
            <h1 className="title">{data.title}</h1>
            <Markdown options={{ wrapper: 'div', forceWrapper: true }} className="description">{data.description}</Markdown>
            {/* <Link className="btn" to={data.Call_to_action.link}>{data.Call_to_action.title}</Link> */}
            <div className="sections">
                <div key={data.first_section.id} className="section first-section">
                    <div className="image">
                        <img src={data.first_section.image.url} />
                    </div>
                    <div className="txt-content">
                        <h2 className="title">{data.first_section.title}</h2>
                        <Markdown options={{ wrapper: 'div', forceWrapper: true }} className="description">{data.first_section.description}</Markdown>
                    </div>
                    <div className="cards">
                        {data.first_section.cards.map((card) =>
                            <div key={card.id} className="card">
                                <div className="icon">
                                    <img src={card.icon.url} />
                                </div>
                                <div className="txt-content">
                                    <h2 className="title">{card.title}</h2>
                                    <Markdown options={{ wrapper: 'div', forceWrapper: true }} className="description">{card.description}</Markdown>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
                {data.page_section.map((section) =>
                    <div key={section.id} className="section">
                        <div className="image">
                            <img src={section.image.url} />
                        </div>
                        <div className="txt-content">
                            <h2 className="title">{section.title}</h2>
                            <Markdown options={{ wrapper: 'div', forceWrapper: true }} className="description">{section.description}</Markdown>
                        </div>
                    </div>
                )}
            </div>
            <div className="garanties">
                <h2 className="title">{data.garanties.title}</h2>
                <Markdown options={{ wrapper: 'div', forceWrapper: true }} className="description">{data.garanties.description}</Markdown>
                <div className="logos">
                    {data.garanties.logos.map((logo) =>
                        <div key={logo.id} className="logo">
                            <img src={logo.image.url} />
                        </div>
                    )}
                </div>
            </div>
            <div className="sections">
                <div key={data.last_section.id} className="section">
                    <div className="image">
                        <img src={data.last_section.image.url} />
                    </div>
                    <div className="txt-content">
                        <h2 className="title">{data.last_section.title}</h2>
                        <Markdown options={{ wrapper: 'div', forceWrapper: true }} className="description">{data.last_section.description}</Markdown>
                    </div>
                </div>
            </div>
            <div className="registration">
                <div className="container">
                    <h2 className="title">{data.registration.title}</h2>
                    <Markdown options={{ wrapper: 'div', forceWrapper: true }} className="description">{data.registration.description}</Markdown>
                    <RegistrationForm />
                </div>
            </div>
        </div>
    </div>
    </div>
  )
}

export async function getServerSideProps() {
  const res = await fetch('https://koleeum-admin.herokuapp.com/proprietaires')
  const data = await res.json()

  return {
    props: {
      data
    }
  }
}
